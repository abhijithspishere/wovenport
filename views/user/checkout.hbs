<!-- breadcrumb -->
<div class="container">
  <div class="bread-crumb flex-w p-l-25 p-r-15 p-t-30 p-lr-0-lg">
    <a href="#" class="stext-109 cl8 hov-cl1 trans-04">
      Home
      <i class="fa fa-angle-right m-l-9 m-r-10" aria-hidden="true"></i>
    </a>

    <span class="stext-109 cl4">
      Shoping Cart
    </span>
  </div>
</div>

<!-- Shoping Cart -->


<div class="container">
  <div class="row">
    <div class="col-lg-10 col-xl-7 m-lr-auto m-b-50">
      <div class="m-l-25 m-r--38 m-lr-0-xl d-flex justify-content-between">

        <div class="wrap-table-shopping-cart col-md-6">
          <br>    </br>
       <a class="btn btn-info" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
      CLICK HERE TO ADD NEW ADDRESS
  </a>
         <div class="collapse" id="collapseExample">
          <form action="/addAddress" method="post">
            <div class="mb-3">
              <label for="email" class="form-label">Name</label>
              <input type="text" class="form-control" id="name" name="name" placeholder="Tony Stark " autofocus />
              <span id="nameError" class="text-danger"></span>

            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Phone</label>
              <input type="text" class="form-control" id="phone" name="mobile" placeholder="+91 12345 67812"
                autofocus />
              <span id="phoneError" class="text-danger"></span>

            </div>
            <div class="mb-3">
              <label for="email" class="form-label">Address</label>
              <input type="text" class="form-control" id="address" name="address" placeholder="ironman@gmail.com"
                autofocus />
              <span id="addressError" class="text-danger"></span>

            </div>
            <div class="mb-3">
              <label for="email" class="form-label">City</label>
              <input type="text" class="form-control" id="city" name="city" placeholder="KLM" autofocus />
              <span id="cityError" class="text-danger"></span>

            </div>
            <div class="mb-3">
              <label for="email" class="form-label">State</label>
              <input type="text" class="form-control" id="state" name="state" placeholder="Kerala" autofocus />
              <span id="stateError" class="text-danger"></span>

            </div>
            <div class="mb-3">
              <label for="email" class="form-label">pincode</label>
              <input type="text" class="form-control" id="zip" name="zip" placeholder="928322" autofocus />
              <span id="zipError" class="text-danger"></span>

            </div>


            <button class="btn btn-primary" type="submit" onclick="return validation()">Add Address</button>


          </form>
          </div>
        </div>
        {{!-- !--------------------- --}}

     

        <form action="/placeOrder" method="post">
          <div class="wrap-table-shopping-cart col-md-6">
            {{#each add}}
            <div style="border: 1px solid rgb(185, 190, 203); border-radius: 10px;" class="box mb-2">
              <div style="width: 600px;" class="col-md-12">
                {{!-- <small class="text-light fw-semibold">default</small> --}}

                <div class="form-check mt-1">
                  <input name="addressId" class="form-check-input" type="radio" value={{_id}} id="defaultRadio1" />

                  <label class="form-check-label" for="defaultRadio1">{{name}}</label>
                  <br>
                  <label class="form-check-label" for="defaultRadio1">{{address}}</label>
                  <br>
                  <label class="form-check-label mb-2 me-1" for="defaultRadio1">{{mobile }}</label>

      <div class="d-flex justify-content-end mt-2">
              <a href="/editAddress?id={{_id}}" class="btn btn-warning btn-sm me-2">Edit</a>
              <a href="/deleteAddress?id={{_id}}" class="btn btn-danger btn-sm">Delete</a>
            </div>
                </div>



              </div>
            </div>

            {{/each}}
           

          </div>
      </div>
    </div>




      <div class="col-sm-10 col-lg-7 col-xl-5 m-lr-auto m-b-50">
      <div class="bor10 p-lr-40 p-t-30 p-b-40 m-l-63 m-r-40 m-lr-0-xl p-lr-15-sm">
        <h4 class="mtext-109 cl2 p-b-30">
 
        </h4>
        <div class="flex-w flex-m m-r-20 m-tb-5">
                <input class="stext-104 cl2 plh4 size-117 bor13 p-lr-20 m-r-10 m-tb-5" type="text" id="coupon" name="coupon"
                  placeholder="Coupon Code">
                  <input type="hidden" name="subTotal" id="subTotal" value="{{totalPrice}}">

                <button onclick="apply()" class="flex-c-m stext-101 cl2 size-118 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer m-tb-5"
                  type="button">
                  Apply coupon
                </button>
            </div>

        <div class="flex-w flex-t bor12 p-b-13">
          <div class="d-flex size-208">
            <h6 id="err" style="font-size: x-small; color:red;" >
            </h6>
          </div>

          <div class="size-209">
            <span class="mtext-110 cl2">
              {{!-- {{totalPrice}} --}}
            </span>
          </div>
        </div>

        <div class="flex-w flex-t bor12 p-t-15 p-b-30">
          <div class="size-208 w-full-ssm">
            <span class="stext-110 cl2">
              Payments:
            </span>
            <div class="form-check mt-1">
              <input name="payment" class="form-check-input" type="radio" value="cod" id="defaultRadio1" />
              <label class="form-check-label" for="defaultRadio1">COD('cash on delivery')</label>

            </div>
            <div class="form-check mt-1">
              <input name="payment" class="form-check-input" type="radio" value="card" id="defaultRadio1" />
              <label class="form-check-label" for="defaultRadio1">Debit/Credit</label>

            </div>
            {{!-- <div class="form-check mt-1">
              <input name="payment" class="form-check-input" type="radio" value="upi" id="defaultRadio1" required />
              <label class="form-check-label" for="defaultRadio1">UPI</label>
            </div> --}}
          </div>

          {{!-- <div class="size-209 p-r-18 p-r-0-sm w-full-ssm">
            <p class="stext-111 cl6 p-t-2">
              There are no shipping methods available. Please double check
              your address, or contact us if you need any help.
            </p>

            <div class="p-t-15">
              <span class="stext-112 cl8">
                Calculate Shipping
              </span>

              <div class="rs1-select2 rs2-select2 bor8 bg0 m-b-12 m-t-9">
                <select class="js-select2" name="time">
                  <option>Select a country...</option>
                  <option>USA</option>
                  <option>UK</option>
                </select>
                <div class="dropDownSelect2"></div>
              </div>

              <div class="bor8 bg0 m-b-12">
                <input class="stext-111 cl8 plh3 size-111 p-lr-15" type="text" name="state"
                  placeholder="State /  country" />
              </div>

              <div class="bor8 bg0 m-b-22">
                <input class="stext-111 cl8 plh3 size-111 p-lr-15" type="text" name="postcode"
                  placeholder="Postcode / Zip" />
              </div>

              <div class="flex-w">
                <div class="flex-c-m stext-101 cl2 size-115 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer">
                  Update Totals
                </div>
              </div>

            </div>
          </div> --}}
        </div>
                 
        <div class="flex-w flex-t p-t-27 p-b-33">

               <table>
                        <tr class="">
                                                                       
                                                                    </tr>
                                                                    <tr class="summary-total">
                                                                        <td style="padding-bottom: 8px;">Subtotal :</td>
                                                                        <td style="color: blue;padding-bottom: 8px;">
                                                                           
                                                                          <span id="fol">  </span>                                                              
                                                                        </td>
                                                                    </tr>

                                                                    <tr class="summary-total">
                                                                        <td  style="padding-bottom: 8px;">
                                                                            Discount :
                                                                        </td>
                                                                        <td style="color: blue;padding-bottom: 8px;">
                                                                          <span id="disc">  </span>
                                                                        </td>
                                                                    </tr>
                                    
                                                                    
                                                                </table>
          <div class="size-208">
            <span class="mtext-101 cl2">
       
            </span>
          </div>

          <div class="size-209 p-t-1">
            <span style="font-weight: bold;">TOTAL :</span>
            <span class="mtext-110 cl2" id="tprice" name="totalPrice"> 
              {{totalPrice}}
            </span>
          </div>
        </div>

        <input type="hidden" name="userid" value={{userid}}>

        {{!-- <button class="flex-c-m stext-101 cl0 size-101 bg1 bor1 hov-btn1 p-lr-15 trans-04 js-addcart-detail">
          <a href="/addToCart?id={{product._id}}">Add to cart</a>

        </button> --}}

        <button class="flex-c-m stext-101 cl0 size-116 bg3 bor14 hov-btn3 p-lr-15 trans-04 pointer js-addcart-detail"
          type="submit">
          Place Order
        </button>
      </div> 
    </div>
  </div>
</div>
</form>
<div>




<script type="text/javascript">
  function validation() {
    var user = document.getElementById('name').value;
    var mno = document.getElementById('phone').value;
    var address = document.getElementById('address').value
    var city = document.getElementById('city').value
    var state = document.getElementById('state').value
    var pincode = document.getElementById('zip').value


    if (user == "") {
      document.getElementById('nameError').innerHTML =
        "Please fill the username field";
      return false;
    }
    if ((user.length <= 2) || (user.length > 20)) {
      document.getElementById('nameError').innerHTML =
        "User length must be between 3 and 20";
      return false;
    }
    if (!isNaN(user)) {
      document.getElementById('nameError').innerHTML =
        "Only characters are allowed";
      return false;
    }
    if (mno == "") {
      document.getElementById('phoneError').innerHTML =
        "please fill the mobile number field";
      return false;
    }
    if (isNaN(mno)) {
      document.getElementById('phoneError').innerHTML =
        "Must write digits only not characters";
      return false;
    }
    if (mno.length != 10) {
      document.getElementById('phoneError').innerHTML =
        "Must be 10 digits ";
      return false;
    }

    if (address == "") {
      document.getElementById('addressError').innerHTML = "Please fill the field"
      return false;
    }

    if (city == "") {
      document.getElementById('cityError').innerHTML = "Please fill the field"
      return false;
    }
    if (state == "") {
      document.getElementById('stateError').innerHTML = "Please fill the field"
      return false;
    }
    if (zip == "") {
      document.getElementById('addressEror').innerHTML = "Please fill the field"
      return false;
    }
    //    if (isNaN(zip)) {
    //     document.getElementById('zipError').innerHTML =
    //       "Must write digits only not characters";
    //      return false;
    //  }
    //       
    //     if (zip.length != 6) {
    //      document.getElementById('zipError').innerHTML =
    //        "Must be 6 digits ";
    //      return false;
    //    }
  }//

        function apply() {
            cop = document.getElementById('coupon').value
            subT = document.getElementById('subTotal').value
            fole = document.getElementById("fol").value
            disce = document.getElementById('disc').value

            console.log(cop,subT)
            $.ajax({
               url: '/addCoupen',
                type: 'POST',
                data: { coupon: cop,totalValue : subT },
                success: function (data) {
                  console.log('ashn',data)
                   if(data.state==1){
                    gTotal = subT-data.disc;
                   document.getElementById('tprice').innerHTML = gTotal;
                     document.getElementById('fol').innerHTML = subT;
                     document.getElementById('disc').innerHTML = data.disc;

                   console.log(gTotal)
                   }else{
                    document.getElementById('err').innerHTML='*invalid coupon'
                    console.log(data.message)
                   }
                 
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.log(textStatus, errorThrown);
                }
            })

        }


</script>